<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NYGMA</title>
  <link rel="icon" href="https://archive.demoweek.prototypefund.de/runde7/assets/images/favicon.svg" sizes="any" type="image/svg+xml">
  <link rel="stylesheet" href="https://archive.demoweek.prototypefund.de/runde7/assets/css/main.css">

  <!-- Twitter Cards -->
  <meta name="twitter:card" content="summary_large_image">
  
  <meta name="twitter:image" content="https://archive.demoweek.prototypefund.de/assets/images/project_images/nygma/header.png">
  <meta name="twitter:title" content="NYGMA">
  <meta name="twitter:description"
    content="NYGMA ist eine Software-Bibliothek zum Analysieren von Computer-Netzwerkdaten. Der Fokus liegt darauf, existierende Produkte um eine wichtige Funktion zu erweitern: Das selektive (Vor-)Filtern von großen Datenbeständen">
  <meta name="twitter:site" content="@prototypefund">
  <!-- Open Graph -->
  <meta property="og:locale" content="de_DE">
  <meta property="og:type" content="article">
  <meta property="og:title" content="NYGMA">
  <meta property="og:description"
    content="NYGMA ist eine Software-Bibliothek zum Analysieren von Computer-Netzwerkdaten. Der Fokus liegt darauf, existierende Produkte um eine wichtige Funktion zu erweitern: Das selektive (Vor-)Filtern von großen Datenbeständen">
  <meta property="og:url" content="https://archive.demoweek.prototypefund.de/projects/17-nygma.html">
  <meta property="og:site_name" content="Prototype Fund Demo Week 2020">
</head>

<body >
  <header>
  <div class="header-container">
    <div class="fix-header">
      <div class="flex-container justify-between align-center">
        <a href="https://prototypefund.de/" style="text-decoration: none;" target="_blank" rel="nofollow noreferrer">
          <div class="logo">
            <svg width="45" height="64" viewBox="0 0 45 55" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M29.5806 3.47559L35.3199 4.17959L42.1081 16.9396L35.3199 27.6609C35.3199 27.6609 27.5726 29.6409 24.6056 30.3449H17.8473V47.6222L23.3169 49.5143L23.182 51.3623L13.4567 51.2302L3.70149 51.3623L3.4917 49.5143L8.9912 47.6222V7.17159L3.50668 5.32359L3.71647 3.47559H29.5806ZM17.8623 26.6636L23.5117 27.7196L32.233 21.7649L34.9303 16.9396L32.233 12.0849L23.5117 6.45292L17.8623 7.18625V26.6636Z"
                fill="#009ACE" />
            </svg>
            <div class="logo-animation">
              <div>Demo</div>
              <div>Week</div>
            </div>
          </div>
        </a>

        <nav>
  <div class="nav-container hidden-xs">
    <ul>
      <li class="nav-links">
        <a href="https://archive.demoweek.prototypefund.de/runde7/#keynote1">Eröffnung</a>
      </li>
      <li class="nav-links">
        <a href="https://archive.demoweek.prototypefund.de/runde7/#project-section">Projekte</a>
      </li>
      <li class="nav-links">
        <a href="https://archive.demoweek.prototypefund.de/runde7/#keynote2">Abschluss</a>
      </li>
    </ul>
  </div>
  <div class="nav-xs-container">
    <input type="checkbox" class="checkbox" hidden id="click">
    <label class="nav-hamburger" for="click"><img
        src="https://archive.demoweek.prototypefund.de/runde7/assets/images/hamburger.png" /></label>
    <ul class="navs">
      <li class="nav-links">
        <a href="https://archive.demoweek.prototypefund.de/runde7/#keynote1">Eröffnung</a>
      </li>
      <li class="nav-links">
        <a href="https://archive.demoweek.prototypefund.de/runde7/#project-section">Projekte</a>
      </li>
      <li class="nav-links">
        <a href="https://archive.demoweek.prototypefund.de/runde7/#keynote2">Abschluss</a>
      </li>
    </ul>
  </div>
</nav>
      </div>
    </div>
  </div>
</header>
  <div class="project-container container">
  <a href="https://archive.demoweek.prototypefund.de/runde7/" class="home-link">
    <div class="flex-container justify-start align-center">
      <img src="https://archive.demoweek.prototypefund.de/runde7/assets/images/back.png" />
      <p>Zurück zur Startseite</p>
    </div>
  </a>
  <div class="flex-container project justify-between">
    <div class="project-details">
      <div class="project-authors">
        
        <a >
          Alexander Wamack
        </a>
        
      </div>
      <h2 class="project-title">NYGMA</h2>
      <p class="project-brief">
        Wir schützen öffentliche Infrastrukturen vor Hacking-Angriffen.
      </p>
      
      <p class="project-description">
        NYGMA ist eine Software-Bibliothek zum Analysieren von Computer-Netzwerkdaten. Der Fokus liegt darauf, existierende Produkte um eine wichtige Funktion zu erweitern: Das selektive (Vor-)Filtern von großen Datenbeständen
      </p>
      
    </div>
    <div class="project-image">
      
      <img src="https://archive.demoweek.prototypefund.de/runde7/assets/images/project_images/nygma/header.png" />
      
    </div>
  </div>
  <div class="project-body">
    <p><em>Kurz: <code class="language-plaintext highlighter-rouge">NYGMA</code> ist eine Software-Bibliothek zum Analysieren von
Computer-Netzwerkdaten. Der Fokus liegt darauf, existierende Produkte um eine
wichtige Funktion zu erweitern: das selektive (Vor-)Filtern von großen
Datenbeständen.</em></p>

<p>Nach wie vor sind Computer-Netzwerke das Ziel von Cyber-Angriffen. Wie kann
man sich oder andere davor schützen? In einer idealen Welt wäre
das Mittel der Wahl natürlich, alle Sicherheitskonzepte und Richtlinien
konsequent umzusetzen. Die Realität aber ist eine andere: große, historisch
gewachsene und unter Umständen schlecht dokumentierte Netzwerk-Topologien
können nicht ohne Einschnitte des Betriebs auf einen entsprechenden
Sicherheitsstandard gebracht werden. Schlimmer noch: Wie kann man sich gegen
noch nicht <em>öffentlich</em> <em>bekannte</em> Sicherheitslücken – wie beispielsweise
CVE-2020-1350 – schützen? Die Antwort ist erschreckend: Erst einmal
überhaupt nicht. Man kann jedoch versuchen, durch gezieltes Monitoring
des Netzwerk-Perimeters und schnelles Handeln im Ernstfall nach einem
erfolgreichen Angriff dessen Auswirkung einschätzen und Gegenmaßnahmen
einleiten. Hier fügt sich <code class="language-plaintext highlighter-rouge">NYGMA</code> in die Liste der Hilfswerkzeuge ein.</p>

<div class="iframe-container">
    <iframe src="https://www.youtube-nocookie.com/embed/dFbkR9pALEQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</div>

<p>Für dieses Monitoring gibt es zahlreiche kommerzielle als auch nicht-kommerziell
verfügbare Produkte. Kommerzielle Lösungen kommen oftmals schon aufgrund 
der Anschaffungs- als auch laufenden Betriebskosten nicht in Frage. Die
gängigsten Open-Source-Software (OSS)-Lösungen <code class="language-plaintext highlighter-rouge">Suricata</code> für
regelbasierte Warnmeldungen und <code class="language-plaintext highlighter-rouge">Zeek</code> für Metadatenerfassung stellen zur
Zeit die Grundlage für ein OSS-basiertes Netzwerk-Sicherheits-Monitoring dar.</p>

<div class="iframe-container">
    <iframe src="https://www.youtube-nocookie.com/embed/sns1dnBmbb0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</div>

<p>Beide Systeme bieten allerdings nicht – oder nur sehr eingeschränkt
– die Möglichkeit, auf Rohmaterial zurückzugreifen. Auch eine Funktion für
das wiederholte und schnelle Beantworten von Suchanfragen bietet keine der
beiden Lösungen. Besonders im Falle von reinen Warnmeldungen fehlen dem*der
Analyst*in wichtige Kontextinformationen, um die Relevanz (false-positive?)
und Kritikalität (true-positive) eines Ereignisses schnell und korrekt
beurteilen zu können. Hier setzt <code class="language-plaintext highlighter-rouge">NYGMA</code> an: <code class="language-plaintext highlighter-rouge">NYGMA</code> ergänzt <code class="language-plaintext highlighter-rouge">Suricata</code> und
<code class="language-plaintext highlighter-rouge">Zeek</code> um die Möglichkeit, aus dem bestehenden Datenbestand Informationen im
Rohformat gezielt abfragen zu können und weitere Erkenntnisse zu gewinnen
oder tiefer gehende Analysen zu ermöglichen.</p>

<div class="iframe-container">
    <iframe src="https://www.youtube-nocookie.com/embed/CKgEsUNJTTs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</div>

<p>Die Vision ist, durch die Kombination von <code class="language-plaintext highlighter-rouge">Suricata</code>, <code class="language-plaintext highlighter-rouge">Zeek</code> und <code class="language-plaintext highlighter-rouge">NYGMA</code>
die Cyber-Abwehrmöglichkeiten <em>für</em> <em>alle</em> zu verbessern. Da Monitoring-Lösungen
im Herzen des eigenen Netzwerks platziert werden, ist es eigentlich
nahezu unumgänglich, eine Open-Source-Lösung einzusetzen. Diese kann von
unabhängigen Spezialist*innen eingesehen werden um sicherzustellen, dass keine
Daten “abfließen” und die Software selbst gängigen Sicherheitsvorschriften
genügt. Bei kommerziellen Black-Boxen ist ein (mehr oder weniger
eingeschränkter) Fernzugriff oder Exfiltration nie auszuschließen,
teilweise sogar verpflichtender Gegenstand eines Wartungs- oder Analysevertrags.
Datenschutz- und Sicherheitsinteressen widersprechen dem selbstredend.</p>

<div class="iframe-container">
    <iframe src="https://www.youtube-nocookie.com/embed/pFefwIZgQVE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</div>

<h2 id="wie-ist-die-idee-entstanden">Wie ist die Idee entstanden?</h2>

<p>Zu den Aufgaben von Computer-Netzwerkspezialist*innen und Cyber-Security-Analyst*innen
gehört unter anderem die Analyse von Netzwerkverkehren. Die Aufgaben
umfassen sowohl die Fehleranalyse als auch die Bewertung von Warnmeldungen aus
Netzwerk-Monitoring-Lösungen. Dabei ist es notwendig, möglichste vollständige
Informationen zu den betrachteten Fällen zu erhalten. Insbesondere bei reinen
Event-basierten Produkten fehlen jedoch häufig die tatsächlich übertragenen Daten
oder weitergehende wichtige Informationen. Auch die regelmäßig enorme Datenmenge 
der Netzwerkdaten stellt für tiefergehende Analysen oftmals ein Problem dar.</p>

<p>Die Idee hinter NYGMA ist einfach: Als Vorstufe für weitergehende Analysen werden
die Netzwerkdaten voranalysiert und nach bestimmten Kriterien sortiert.
Diese Sortierung wird dann durch <code class="language-plaintext highlighter-rouge">NYGMA</code> ausgenutzt, um gezielt einzelne
Datensätze aus dem Rohmaterial zu extrahieren und an ein nachgelagertes
Analyseprogramm weiterzuleiten. Idealerweise spielt es dabei keine Rolle,
ob die Daten in Echtzeit “sortiert” bzw. bearbeitet werden oder ein bereits
vorhandener Datenbestand analysiert werden muss.</p>

<p>Dieses Vorgehen ermöglicht Analyst*innen, eigene Werkzeuge und Verfahren
auf selektierte Ausschnitte von Datenströmen anzuwenden. Weitergehende
Erkenntnisse können wiederum eine erneute Selektion erfordern. Diese
wiederholten Anfragen sind die Stärken von <code class="language-plaintext highlighter-rouge">NYGMA</code>. Durch die Sortierung
können diese sehr schnell und effizient abgearbeitet werden.</p>

<p>Anfragen an <code class="language-plaintext highlighter-rouge">NYGMA</code> können auch automatisiert erfolgen. So können beispielsweise 
bei einem Security-Event aus dem Monitoring die Daten der betreffenden
Kommunikationspartner abgefragt und weiter bearbeitet werden.</p>

<h2 id="anwendungsbereiche">Anwendungsbereiche</h2>

<p>Die Zielgruppe von <code class="language-plaintext highlighter-rouge">NYGMA</code> sind Netzwerkadministrator*innen und
Cyber-Security-Analyst*innen, die bereits mit <code class="language-plaintext highlighter-rouge">Suricata</code> oder <code class="language-plaintext highlighter-rouge">Zeek</code> arbeiten
und eine Lösung für die Aufbereitung von Computer-Netzwerkdaten
benötigen. Konkrete Anwendungsfälle reichen von der Fehlersuche in
Netzwerken, leistungsorientierten Optimierungen oder forensischen Untersuchungen bis hin
zu Analysen nach oder während eines erfolgreichen Angriffs (Incident-Response).</p>

<p>Auch in Schulungen zu Netzwerken allgemein kann <code class="language-plaintext highlighter-rouge">NYGMA</code> eingesetzt werden. Dies
wird in dem technischen Workflow anhand einer forensischen Untersuchung in kleinem
Umfang demonstriert: <a href="https://github.com/stackless-goto/prototypefund-demoweek/tree/master/workflow">github/prototypefund-demoweek</a> (Dieses Beispiel ist sehr technisch und für das Verständnis ist Vorerfahrung im Umgang mit Computer-Netzwerken notwendig.)</p>

<p>Die stärke von <code class="language-plaintext highlighter-rouge">NYGMA</code> liegt darin, dass es kein einzelnes Programm
sondern eine Bibliothek ist die auf den konkreten Einsatzzweck – also das
eigene Netzwerk – umfassend angepasst werden kann. Auch wird keinerlei Annahme
über die Daten selbst getroffen. Zum Export der Daten werden Standardformate
verwendet. Damit läßt sich die Software komfortabel integrieren.</p>

<h2 id="vorgehensweise-bei-der-entwicklung">Vorgehensweise bei der Entwicklung</h2>

<p><code class="language-plaintext highlighter-rouge">NYGMA</code> ist in <code class="language-plaintext highlighter-rouge">C++20</code> implementiert. Die Projektplanung erfolgte in
Absprache mit dem Prototype Fund jeweils wöchentlich eine Woche im Voraus
sowie mit einem kurzen Rückblick der vergangenen Woche.</p>

<p>Die Implementierung selbst erfolgte angelehnt an ein <em>Test-Driven-Development</em>:
Für jede <em>wichtige</em> Funktionalität wurden einzeln ausführbare <em>Unit-Tests</em>
implementiert. Die Tests wurden zusammen mit der tatsächlichen Implementierung
entworfen.</p>

<p>Zusätzlich wurden auch Test-Treiber für ein Fuzzing der Komponenten
bereitgestellt. Die Treiber bzw. Fuzzer basieren auf <code class="language-plaintext highlighter-rouge">libFuzzer</code> und
<code class="language-plaintext highlighter-rouge">honggfuzz</code>. Durch die frühe Integration der Fuzzing-Komponenten in
Kombination mit den Unit-Tests konnte parallel zur Entwicklung eine
QA (Quality Assurance) des <code class="language-plaintext highlighter-rouge">C++</code>-Codes erfolgen.</p>

<p>Gerade bei der Entwicklung des Prototypen war dieses Vorgehen besonders
wichtig: Änderungen, z. B. an den Algorithmen und Datenstrukturen, können
schnell im Rahmen der Test-Cases auf entsprechende Korrektheit überprüft
werden.</p>

<ul>
  <li><a href="https://github.com/google/honggfuzz">~google/honggfuzz</a></li>
  <li><a href="https://llvm.org/docs/LibFuzzer.html">~llvm/libFuzzer</a></li>
</ul>

<h2 id="herausforderungen">Herausforderungen</h2>

<p>Die größte Herausforderung war die Auswahl und Implementierung der
Algorithmen. Für die Komprimierung der Index-Daten wurden unterschiedliche
Verfahren getestet. Die Herausforderung lag im wesentlichen darin, nicht zu
viel Zeit in Optimierungen und Benchmarking zu investieren und dennoch eine gute
Performanz mit dem Prototypen zu erreichen.</p>

<h2 id="future-work">Future Work</h2>

<p>Beim Verarbeiten der Daten werden spezielle Befehle (SIMD: SSE und AVX)
der Intel-X86 Prozessoren verwendet. Eine Portierung der Software für die
64Bit-ARM Architektur (aarch64/NEON) ist geplant.</p>

<p>Bei der Implementierung der Komprimierungsalgorithmen entstand die Idee für
eine angepasste Methode mit höherem Komprimierungspotential. Die Umsetzung
dieser Idee ist ein weiterer Meilenstein.</p>

<p>Im Rahmen der <em>Prototyp-Entwicklung</em> lag der Fokus auf forensischen
Untersuchungen eines bestehenden Datensatzes. Dies ist besonders hilfreich,
um bei der Entwicklung stets mit deterministischen Datenströmen
arbeiten zu können. Als wichtige Erweiterung von <code class="language-plaintext highlighter-rouge">NYGMA</code> steht die
<em>Live-Datenverarbeitung</em> an oberster Stelle.</p>

<p>Mit Hilfe des <em>Live-Capturing</em> wird eine Lösung zum Domain-Name-System (DNS)
Monitoring entwickelt, die basierend auf den Eigenschaften von <code class="language-plaintext highlighter-rouge">NYGMA</code>
als leichtgewichtiges Intrusion-Detection-System (IDS) eingesetzt werden kann.</p>

<ul>
  <li><a href="https://www.first.org/conference/2005/papers/florian-weimer-paper-1.pdf">Passive DNS Replication - Florian Weimer</a></li>
</ul>

<h2 id="eure-hilfe-ist-gefragt">Eure Hilfe ist gefragt</h2>

<p>Auch wenn die Funktionalität von <code class="language-plaintext highlighter-rouge">NYGMA</code> bereits umfangreich ist,
handelt es sich immer noch um einen Prototypen. Damit das Projekt auch
weiterhin existieren kann, ist Mithilfe aus der Community gefragt: Sei es durch
Programmierleistung, Dokumentation, Integerations-Tests, Fuzzing, Uses-Case
Beispiele oder auch finanzielle Unterstützung für die Entwicklung weiterer
Features.</p>

<p>Wendet euch mit jeglichem Feedback gerne an <a href="mailto:al3x@64k.by">al3x@64k.by</a>.</p>

<p><code class="language-plaintext highlighter-rouge">NYGMA</code> wird auf freiberuflicher Basis als Open-Source-Software unter
einer freizügigen Lizenz (Blue-Oak License, ähnlich zu MIT/ISC) gepflegt.</p>

<h2 id="danksagung">Danksagung</h2>

<p><code class="language-plaintext highlighter-rouge">NYGMA</code> wurde durch das Bundesministerium für Bildung und Forschung (BMBF)
gefördert. Besonderer Dank geht an das DLR für die Unterstützung bei
der Antragstellung und Hilfe bei allen organisatorischen Fragen. Absolut
beeindruckend war die Projektbegleitung durch den Prototype Fund. Ohne die
vielen Gespräche, wertvolles Feedback und die Organisation von <a href="https://twitter.com/_Tasmo">@tasmo</a>, <a href="https://twitter.com/shiromarieke">@shiromarieke</a>, Patricia Leu, <a href="https://twitter.com/KthrnMeyer">@KthrnMeyer</a> und <a href="https://twitter.com/avwgo">@AVWG</a> wäre dieses Projekt nicht
möglich gewesen. Vielen, vielen Dank an alle beteiligten des Prototype Fund!</p>

<h2 id="projekt-links">Projekt-Links</h2>

<p>Eine Übersicht über die Projekte, die während der Projektzeit entstanden sind:</p>

<table>
  <thead>
    <tr>
      <th>Quell-Code</th>
      <th>Zweck</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://github.com/stackless-goto/nygma">nygma</a></td>
      <td>Hauptprojekt, Index, Abfrage</td>
    </tr>
    <tr>
      <td><a href="https://github.com/stackless-goto/g0tham">gotham</a></td>
      <td>Demo User-Interface, Muster-Index</td>
    </tr>
    <tr>
      <td><a href="https://github.com/stackless-goto/libforest">libforest</a></td>
      <td>B+Tree Implementierungen</td>
    </tr>
    <tr>
      <td><a href="https://github.com/stackless-goto/libunclassified">libunclassified</a></td>
      <td>Support Code, Logging</td>
    </tr>
    <tr>
      <td><a href="https://github.com/stackless-goto/pest">pest</a></td>
      <td>Unit-Tests und Benchmarking</td>
    </tr>
  </tbody>
</table>


  </div>
</div>
  <footer>
  <div class="flex-container separator-container justify-between align-center">
    <div class="blue-label separator-banner">
      <div>Demo</div>
      <div>Week</div>
    </div>
    <div class="pink-label separator-banner">
      <div>Demo</div>
      <div>Week</div>
    </div>
    <div class="blue-label separator-banner">
      <div>Demo</div>
      <div>Week</div>
    </div>
    <div class="pink-label separator-banner">
      <div>Demo</div>
      <div>Week</div>
    </div>
    <div class="blue-label separator-banner">
      <div>Demo</div>
      <div>Week</div>
    </div>
    <div class="pink-label separator-banner">
      <div>Demo</div>
      <div>Week</div>
    </div>
  </div>
  <div class="footer-container">
    <div class="flex-container justify-between footer-details">
      <div class="footer-desc">
        <p>
          Der Prototype Fund ist ein Projekt der Open Knowledge Foundation Deutschland e. V.,
          das vom Bundesministerium für Bildung und Forschung (BMBF) gefördert wird.
        </p>
        <div class="flex-container justify-start align-center">
          <img src="https://archive.demoweek.prototypefund.de/runde7/assets/images/footer_logo.svg" />
          <img src="https://archive.demoweek.prototypefund.de/runde7/assets/images/logo-okfn.png" style="margin-left: 5rem;" />
        </div>
      </div>
      <div class="social-container">
        <p>join the conversation<br />#prototypefund</p>
        <div class="social-links">
          <p>follow us:</p>
          <div class="flex-container justify-end">
            <a href="https://twitter.com/prototypefund" target="_blank" rel="nofollow noreferrer"><img
                src="https://archive.demoweek.prototypefund.de/runde7/assets/images/social_icons/twitter.png" /></a>
            <a href="https://mastodon.social/@PrototypeFund" target="_blank" rel="nofollow noreferrer"><img
                src="https://archive.demoweek.prototypefund.de/runde7/assets/images/social_icons/mastodon.png" /></a>
          </div>
        </div>
        <div class="links-container">
          <a class="link" href="https://prototypefund.de/code-of-conduct/" target="_blank"
            rel="nofollow noreferrer">Code of Conduct</a>
          <a class="link" href="https://prototypefund.de/impressum/" target="_blank" rel="nofollow noreferrer">Impressum
            / Datenschutz</a>
        </div>
      </div>
    </div>
  </div>
</footer>
</body>

</html>